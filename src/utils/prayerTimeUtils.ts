
// Extended data structure with specific times for filtering
export const prayerTimesData = {
  'Northern Natal': [
    { fajr: '06:05', dhuhr: '12:35', asr: '16:15', maghrib: '17:45', isha: '19:15', masjid: 'Darul Quran Masjid', address: 'Daisy Ave, Ladysmith', district: 'Ladysmith', type: 'MASJID' },
    { fajr: '05:50', dhuhr: '13:20', asr: '16:15', maghrib: '17:50', isha: '19:30', masjid: 'Masjid Abu Huraira', address: '242 Boeren St, Vryheid', district: 'Vryheid', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '13:20', asr: '16:15', maghrib: '17:55', isha: '19:00', masjid: 'Masjid Al-Kibriya', address: '12 Dromedaris St, Ladysmith', district: 'Ladysmith', type: 'MASJID' },
    { fajr: '05:45', dhuhr: '13:15', asr: '16:00', maghrib: '17:50', isha: '19:15', masjid: 'Newcastle Masjid', address: '28 Murchison St, Newcastle', district: 'Newcastle', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '13:15', asr: '16:30', maghrib: '18:00', isha: '19:05', masjid: 'Masjid Al Qaseehullah', address: '5 Tagore Rd, Ladysmith', district: 'Ladysmith', type: 'MASJID' },
    { fajr: '05:45', dhuhr: '13:00', asr: '16:30', maghrib: '18:05', isha: '19:15', masjid: 'Masjid Rabia', address: '11 Brokensha Rd, Estcourt', district: 'Estcourt', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '13:00', asr: '16:30', maghrib: '17:45', isha: '19:15', masjid: 'Bergville Musallah', address: '47 Tathum Rd, Bergville', district: 'Bergville', type: 'MUSALLA' },
    { fajr: '06:00', dhuhr: '13:15', asr: '16:00', maghrib: '17:45', isha: '19:15', masjid: 'Jantha Masjid', address: 'Jantha Street, Ladysmith', district: 'Ladysmith', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '12:35', asr: '16:00', maghrib: '17:45', isha: '19:15', masjid: 'Poona Masjid', address: '48 Poona Rd, Ladysmith', district: 'Ladysmith', type: 'MASJID' },
  ],
  'South Coast': [
    { fajr: '06:00', dhuhr: '13:20', asr: '16:15', maghrib: '17:55', isha: '19:00', masjid: 'Harding Jumuah Masjid', address: '4 Musgrave St, Harding', district: 'Harding', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '13:15', asr: '16:15', maghrib: '17:45', isha: '19:15', masjid: 'Matafal Musalla', address: 'shop 1 Joggers st, Matatiele', district: 'Transkei', type: 'MUSALLA' },
    { fajr: '06:00', dhuhr: '13:15', asr: '16:15', maghrib: '17:50', isha: '19:15', masjid: 'Port Shepstone Juma Masjid', address: '41 Reynolds St, Port Shepstone', district: 'Port Shepstone', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '13:15', asr: '16:00', maghrib: '18:00', isha: '19:00', masjid: 'Umzinto Jaame Masjid', address: 'Nelson Mandela Road, Umzinto', district: 'Umzinto', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '13:10', asr: '16:00', maghrib: '18:05', isha: '19:00', masjid: 'Masjid Ayesha', address: '8 Pluto Rd, Grosvenor, Port Shepstone', district: 'Port Shepstone', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '13:15', asr: '16:00', maghrib: '17:50', isha: '19:00', masjid: 'Shelly Beach Musalla', address: '53 Marine Drive Windsor on Sea, Shelly Beach', district: 'Port Shepstone', type: 'MUSALLA' },
    { fajr: '06:00', dhuhr: '13:00', asr: '16:00', maghrib: '18:00', isha: '19:00', masjid: 'Amooti Zanzaibari Musalla', address: '120141 St, Etafuleni, Amaoti', district: 'Verulam', type: 'MUSALLA' },
  ],
  'Durban': [
    { fajr: '05:45', dhuhr: '12:45', asr: '16:30', maghrib: '17:50', isha: '19:15', masjid: 'Asherville - Masjid Noor', address: '123 Mallinson Road, Asherville', district: 'Asherville', type: 'MASJID' },
    { fajr: '05:30', dhuhr: '12:40', asr: '16:30', maghrib: '17:45', isha: '19:00', masjid: 'Avondale - Hillcrest Masjid', address: '7 Emser road, Avondale', district: 'Avondale', type: 'MASJID' },
    { fajr: '05:45', dhuhr: '12:45', asr: '16:30', maghrib: '18:00', isha: '19:15', masjid: 'Berea - Alcock Musallah', address: '4 Robinson Place', district: 'Berea', type: 'MUSALLA' },
    { fajr: '05:10', dhuhr: '11:37', asr: '15:35', maghrib: '17:40', isha: '18:34', masjid: 'Bonela - Masjid Al Quba', address: '44 Bonela Rd', district: 'Bonela', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '13:00', asr: '16:15', maghrib: '17:55', isha: '19:15', masjid: 'Bonela - Masjid Umar Farooq', address: '17 Jubilee Crescent, Bonela', district: 'Bonela', type: 'MASJID' },
    { fajr: '05:40', dhuhr: '13:00', asr: '16:00', maghrib: '17:45', isha: '19:15', masjid: 'Chatsworth - Chisti Sabri Masjid', address: '112 Woodhurst Dr', district: 'Chatsworth', type: 'MASJID' },
    { fajr: '05:50', dhuhr: '13:10', asr: '16:00', maghrib: '17:45', isha: '19:00', masjid: 'Durban Central - Broad Street Musalla', address: '10 Anul Dadoo Street', district: 'City', type: 'MUSALLA' },
    { fajr: '05:45', dhuhr: '12:30', asr: '15:50', maghrib: '17:40', isha: '19:00', masjid: 'Durban Central - Incoama Shadi Musalla', address: '143A Fishmarket Street, Durban 4001', district: 'City', type: 'MUSALLA' },
    { fajr: '05:50', dhuhr: '13:10', asr: '16:15', maghrib: '18:00', isha: '19:00', masjid: 'Durban Central - Juma Masjid Grey Street', address: 'Dr Yusuf Dadoo Street', district: 'City', type: 'MASJID' },
    { fajr: '05:30', dhuhr: '13:15', asr: '16:15', maghrib: '17:45', isha: '19:00', masjid: 'Durban Central - Masjid Maryam', address: '48 Simon Mzoleli Street', district: 'City', type: 'MASJID' },
    { fajr: '05:45', dhuhr: '13:00', asr: '16:15', maghrib: '17:50', isha: '19:10', masjid: 'Westville Masjid', address: '25 Jan Hofmeyr Road', district: 'Westville', type: 'MASJID' },
    { fajr: '05:40', dhuhr: '12:50', asr: '16:10', maghrib: '17:45', isha: '19:05', masjid: 'Newlands Masjid', address: '45 Riverside Road', district: 'Newlands', type: 'MASJID' },
  ],
  'Midlands': [
    { fajr: '06:00', dhuhr: '13:15', asr: '16:30', maghrib: '17:55', isha: '19:00', masjid: 'Jalisvery Masjid', address: '487 Church St, Pietermaritzburg', district: 'Pietermaritzburg', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '13:15', asr: '16:30', maghrib: '18:00', isha: '19:15', masjid: 'Qopa Jumuah Masjid', address: '103 Chapel St, eXobho', district: 'Ixopo', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '13:15', asr: '16:15', maghrib: '17:50', isha: '19:00', masjid: 'Mountain Rise Masjid', address: '104 Royston Rd, Mountain Rise, Pietermaritzburg', district: 'Pietermaritzburg', type: 'MASJID' },
    { fajr: '05:45', dhuhr: '13:15', asr: '16:15', maghrib: '17:45', isha: '19:15', masjid: 'Northern Park Masjid', address: '63 Linscott Rd, Northern Park, Pietermaritzburg', district: 'Pietermaritzburg', type: 'MASJID' },
    { fajr: '05:50', dhuhr: '13:15', asr: '16:15', maghrib: '17:50', isha: '19:15', masjid: 'Richmond Masjid', address: 'Russel St, Richmond', district: 'Richmond', type: 'MASJID' },
    { fajr: '05:45', dhuhr: '13:15', asr: '16:15', maghrib: '17:55', isha: '19:15', masjid: 'Masjidue Sawliheen', address: '480 Prince Alfred St, Pietermaritzburg', district: 'Pietermaritzburg', type: 'MASJID' },
    { fajr: '05:30', dhuhr: '12:40', asr: '16:15', maghrib: '17:40', isha: '19:15', masjid: 'Masjid Khadijatul Kubra', address: '11 Carbis Rd, Scottsville, Pietermaritzburg', district: 'Pietermaritzburg', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '12:45', asr: '16:30', maghrib: '17:45', isha: '19:15', masjid: 'Musallah Umar', address: '43 Dykes Rd, Montrose, Pietermaritzburg', district: 'Pietermaritzburg', type: 'MUSALLA' },
    { fajr: '05:45', dhuhr: '12:30', asr: '16:15', maghrib: '17:40', isha: '19:00', masjid: 'Victoria Road Masjid', address: '328 Victoria Rd, Pietermaritzburg', district: 'Pietermaritzburg', type: 'MUSALLA' },
    { fajr: '06:00', dhuhr: '13:15', asr: '16:15', maghrib: '17:45', isha: '19:00', masjid: 'Manor Masjid', address: '5 Wallace Rd, Manor, Pietermaritzburg', district: 'Pietermaritzburg', type: 'MUSALLA' },
    { fajr: '05:40', dhuhr: '13:20', asr: '16:15', maghrib: '17:45', isha: '19:15', masjid: 'Camperdown Masjid', address: '32 Bishop St, Camperdown', district: 'Camperdown', type: 'MASJID' },
    { fajr: '06:00', dhuhr: '13:00', asr: '16:15', maghrib: '17:45', isha: '19:00', masjid: 'Willowton Masjid', address: '8 Maryvale Rd, Willowton, Pietermaritzburg', district: 'Pietermaritzburg', type: 'MUSALLA' },
  ],
  'North Coast': [
    { fajr: '06:00', dhuhr: '13:15', asr: '16:15', maghrib: '17:55', isha: '19:15', masjid: 'Anjuman Islam Juma Masjid', address: '18 Railway St, Tongaat', district: 'Tongaat', type: 'MASJID' },
    { fajr: '05:50', dhuhr: '13:15', asr: '16:15', maghrib: '17:50', isha: '19:00', masjid: 'Empangeni Jumu\'ah Masjid', address: '26 North Rd, Empangeni Central, Empangeni', district: 'Empangeni', type: 'MASJID' },
    { fajr: '05:45', dhuhr: '13:15', asr: '16:30', maghrib: '18:00', isha: '19:00', masjid: 'La Mercy Masjid', address: '2 Coull Dr, La Mercy', district: 'La Mercy', type: 'MASJID' },
    { fajr: '05:45', dhuhr: '13:15', asr: '16:15', maghrib: '17:45', isha: '19:15', masjid: 'Raisetville Masjid', address: '78 Trevenen Rd, Valdin Heights, Verulam', district: 'Verulam', type: 'MASJID' },
    { fajr: '05:50', dhuhr: '13:15', asr: '16:15', maghrib: '17:50', isha: '19:00', masjid: 'Masjid-un-Nur', address: 'Lavoipierre Dr, Stanger Ext 25, KwaDukuza', district: 'Stanger', type: 'MASJID' },
    { fajr: '05:45', dhuhr: '13:15', asr: '16:15', maghrib: '17:45', isha: '19:15', masjid: 'Quwwatul Islam Jaame Masjid', address: '150 Wick St, Verulam', district: 'Verulam', type: 'MASJID' },
    { fajr: '05:45', dhuhr: '13:15', asr: '16:15', maghrib: '17:50', isha: '19:15', masjid: 'Riyodh Musallah', address: '34 As-Safa Way, Riyadh, Verulam', district: 'Verulam', type: 'MUSALLA' },
    { fajr: '05:40', dhuhr: '13:15', asr: '16:15', maghrib: '17:45', isha: '19:15', masjid: 'Stanger Jaamia Masjid', address: 'Mahatma Ghandi St, KwaDukuza Central, Stanger', district: 'Stanger', type: 'MASJID' },
    { fajr: '05:50', dhuhr: '13:15', asr: '16:00', maghrib: '17:50', isha: '19:15', masjid: 'Verulam Central Masjid', address: '89 Wick St, Verulam', district: 'Verulam', type: 'MASJID' },
    { fajr: '05:40', dhuhr: '13:20', asr: '16:00', maghrib: '17:45', isha: '19:00', masjid: 'Richards Bay Masjid', address: 'Tassel-Berry, Arboretum, Richards Bay', district: 'Richards Bay', type: 'MASJID' },
    { fajr: '05:45', dhuhr: '13:15', asr: '16:00', maghrib: '17:45', isha: '18:50', masjid: 'Stanger North Masjid', address: '21 North St, Stanger Ext 14, KwaDukuza', district: 'Stanger', type: 'MASJID' },
  ]
};

export type PrayerType = 'fajr' | 'dhuhr' | 'asr' | 'maghrib' | 'isha';
export type SearchType = 'earliest' | 'latest';
export type MasjidData = { 
  fajr: string; 
  dhuhr: string; 
  asr: string; 
  maghrib: string; 
  isha: string; 
  masjid: string;
  address?: string;
  district?: string;
  type?: string;
};

// Updated subregion data to include Westville and Newlands for Durban
export const subRegionsData = {
  'Northern Natal': ['Newcastle', 'Ladysmith', 'Dundee', 'Vryheid', 'Estcourt', 'Bergville'],
  'South Coast': ['Port Shepstone', 'Margate', 'Scottburgh', 'Umkomaas', 'Harding', 'Umzinto'],
  'Durban': ['North', 'South', 'City', 'Overport', 'Suburbs', 'Chatsworth', 'Phoenix', 'Bluff', 'Westville', 'Newlands'],
  'Midlands': ['Pietermaritzburg', 'Richmond', 'Howick', 'Scottsville', 'Montrose'],
  'North Coast': ['Stanger', 'Ballito', 'Tongaat', 'Verulam', 'Empangeni', 'Richards Bay', 'La Mercy']
};

// Get all unique times for a specific prayer type across all regions
export const getUniquePrayerTimes = (prayerType: PrayerType): string[] => {
  const allTimes: string[] = [];
  Object.values(prayerTimesData).forEach(region => {
    region.forEach(masjid => {
      if (!allTimes.includes(masjid[prayerType])) {
        allTimes.push(masjid[prayerType]);
      }
    });
  });
  return allTimes.sort();
};

// Generate time blocks for filtering
export const generateTimeBlocks = (prayerType: PrayerType) => {
  const times = getUniquePrayerTimes(prayerType);
  const earliestTime = times[0];
  const latestTime = times[times.length - 1];
  
  return { times, earliestTime, latestTime };
};

export const prayerInfo = {
  fajr: { label: 'Fajr', arabicLabel: 'Subh Saadiq' },
  dhuhr: { label: 'Dhuhr', arabicLabel: 'Zawaal' },
  asr: { label: 'Asr', arabicLabel: 'Asr' },
  maghrib: { label: 'Maghrib', arabicLabel: 'Maghrib' },
  isha: { label: 'Isha', arabicLabel: 'Isha' },
};

// Get distinct times for a specific prayer type in a specific region
export const getDistinctTimes = (prayerType: PrayerType, region: string): string[] => {
  const regionData = prayerTimesData[region as keyof typeof prayerTimesData] || [];
  
  // Extract all times for the prayer type from the region
  const times = regionData.map(item => item[prayerType]);
  
  // Filter to get only distinct times and sort them
  const distinctTimes = Array.from(new Set(times)).sort((a, b) => {
    const [hoursA, minutesA] = a.split(':').map(Number);
    const [hoursB, minutesB] = b.split(':').map(Number);
    
    // Compare hours first
    if (hoursA !== hoursB) {
      return hoursA - hoursB;
    }
    
    // If hours are the same, compare minutes
    return minutesA - minutesB;
  });
  
  return distinctTimes;
};

export const findExtremeTime = (
  prayer: PrayerType,
  type: SearchType,
  selectedRegion: string | null
) => {
  if (!selectedRegion) return null;
  
  const prayerTimes = prayerTimesData[selectedRegion as keyof typeof prayerTimesData];
  if (!prayerTimes?.length) return null;
  
  // Convert time strings to comparable values (minutes since midnight)
  const timeValues = prayerTimes.map(item => {
    const [hours, minutes] = item[prayer].split(':').map(Number);
    return {
      value: hours * 60 + minutes,
      time: item[prayer],
      masjid: item.masjid
    };
  });
  
  // Find earliest or latest time
  if (type === 'earliest') {
    return timeValues.reduce((min, time) => time.value < min.value ? time : min, timeValues[0]);
  } else {
    return timeValues.reduce((max, time) => time.value > max.value ? time : max, timeValues[0]);
  }
};
